<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">Mi Perfil</h2>
                    
                    <div id="profile-content" class="d-none">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <p><strong>Nombre:</strong> <span id="user-firstname"></span></p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Apellido:</strong> <span id="user-lastname"></span></p>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <p><strong>Email:</strong> <span id="user-email"></span></p>
                        </div>
                        
                        <div class="mb-3">
                            <p><strong>Rol:</strong> <span id="user-role"></span></p>
                        </div>

                        <div class="d-grid gap-2">
                            <button id="logout-button" class="btn btn-danger">Cerrar Sesión</button>
                        </div>
                    </div>

                    <div id="loading" class="text-center">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                    </div>

                    <div id="error-message" class="alert alert-danger mt-3 d-none">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/auth.js"></script>
<script>
document.addEventListener('DOMContentLoaded', async function() {
    const profileContent = document.getElementById('profile-content');
    const loading = document.getElementById('loading');
    const errorMessage = document.getElementById('error-message');

    try {
        const user = await checkAuthStatus();
        if (!user) {
            throw new Error('No se pudo obtener la información del usuario');
        }

        // Actualizar la información del usuario en el DOM
        document.getElementById('user-firstname').textContent = user.first_name;
        document.getElementById('user-lastname').textContent = user.last_name;
        document.getElementById('user-email').textContent = user.email;
        document.getElementById('user-role').textContent = user.role;

        // Mostrar el contenido y ocultar el loading
        profileContent.classList.remove('d-none');
    } catch (error) {
        errorMessage.textContent = error.message;
        errorMessage.classList.remove('d-none');
    } finally {
        loading.classList.add('d-none');
    }
});
</script>
